{% extends 'base.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    {% block content %}
    <link rel="stylesheet" href="{% static 'myProfile.css' %}">
    <link rel="stylesheet" href="{% static 'globalFeed.css' %}">
        <div class="profile">
            <div class="profile-banner">
                <!-- <img src="#"> -->
            </div>
            <div class="profile-info">
                <div class="top">

                    {% if usuario.profileImage %}
                        <img src="{{usuario.profileImaeg}} " alt="" class="profilePhoto">
                    {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><title>ProfileIcon</title><circle cx="16" cy="16" r="16" fill="#666"/><path d="M12.73 13.1a3.271 3.271 0 1 1 3.27 3.2 3.237 3.237 0 0 1-3.27-3.2zm-2.73 9.069h1.088a4.91 4.91 0 0 1 9.818 0h1.094a5.884 5.884 0 0 0-3.738-5.434 4.238 4.238 0 0 0 2.1-3.635 4.366 4.366 0 0 0-8.73 0 4.238 4.238 0 0 0 2.1 3.635 5.878 5.878 0 0 0-3.732 5.434z" fill="#eee"/><path fill="none" d="M0 0h32v32h-32z"/></svg>
                    {% endif %}
    
                    {% if is_self %}
                        <button class="editButton">Editar</button>
                    {% endif %}
                    <section class="modal2">
                        <div class="modal_container">
                            <button href="#" class="modal_close">X</button>
                            {% if usuario.profileImage %}
                                <img src="{{usuario.profileImaeg}} " alt="" class="profilePhoto">
                            {% else %}
                            <div class="editImage">                              
                                <svg class="imgToEdit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><title>ProfileIcon</title><circle cx="16" cy="16" r="16" fill="#666"/><path d="M12.73 13.1a3.271 3.271 0 1 1 3.27 3.2 3.237 3.237 0 0 1-3.27-3.2zm-2.73 9.069h1.088a4.91 4.91 0 0 1 9.818 0h1.094a5.884 5.884 0 0 0-3.738-5.434 4.238 4.238 0 0 0 2.1-3.635 4.366 4.366 0 0 0-8.73 0 4.238 4.238 0 0 0 2.1 3.635 5.878 5.878 0 0 0-3.732 5.434z" fill="#eee"/><path fill="none" d="M0 0h32v32h-32z"/></svg>
                                <input type="file">
                            </div>
                                
                            {% endif %}
                        </div>
                    </section>
                </div>
                <div class="followName">

                    <h3 class="username">{{usuario.user.username}}</h3>
                    {% if not is_self %}
                            {% if current_user not in usuario.followers_users.all %}
                            <form action="{% url 'follow' id=usuario.id %}?return_url={{ request.path }}" method="POST">
                                {% csrf_token %}
                                <button type="submit" class="followButton">Follow</button>
                            </form>
                            {% else %}
                            <form action="{% url 'follow' id=usuario.id %}?return_url={{ request.path }}" method="POST">
                                {% csrf_token %}
                                <button type="submit" class="followButton">Unfollow</button>
                            </form>
                        {% endif %}
                    
                            
                    {% endif %}
                    
                </div>
                <h4 class="atName">@{{usuario.username}}</h4>                
                <h4 class="createdAt">Se union en {{ usuario.created_at|date:"F" }} de {{ usuario.created_at|date:"Y" }}</h4>
                <div class="followers-info">
                    {% if cant_followers == 1 %}
                        <a href="#" class="cant_followers">{{cant_followers}} <span>seguidor</span></a>
                    {% else %}
                        <a href="#" class="cant_followers">{{cant_followers}} <span>seguidores</span></a>
                    {% endif %}
                    <h4>0 <span>siguiendo</span></h4>
                </div>
                <h1 class="myTweets">Mis tweets</h1>
            </div>
            <section class="modal">
                <div class="modal_container">
                    <button href="#" class="modal_close">X</button>
                    <h1>Seguidores</h1>
                    <div class="seguidores">
                        {% for follower in followers %}
                            <div class="seguidor">
                                <div class="username">
                                    <form action="{% url 'myProfile' follower.user.username %}">
                                        <button class="usernameTweet">{{follower.user.username}}</button>
                                    </form>
                                    <p>@{{follower.username}}</p>

                                </div>
                                <!-- {% if follower.user.id == current_profile.user.id  %} -->
                                    {% if current_user not in follower.followers_users.all %}
                                        <form action="{% url 'follow' id=follower.id %}?return_url={{ request.path }}" method="POST">
                                            {% csrf_token %}
                                            <button type="submit" class="followButton">Follow</button>
                                        </form>
                                    {% else %}
                                        <form action="{% url 'follow' id=follower.id %}?return_url={{ request.path }}" method="POST">
                                            {% csrf_token %}
                                            <button type="submit" class="followButton">Unfollow</button>
                                        </form>
                                    {% endif %}
                            
                                    
                                <!-- {% endif %} -->
                            </div>
                        {% endfor %}

                    </div>
                </div>
            </section>
                <div class="tweets">

                    {% for tweet in tweets %}
        
                            {% include 'Tweet.html' %}
                    {% endfor %}
                </div>
    
            </div>
        <script>
            const modal = document.querySelector('.modal')
            const modal2 = document.querySelector('.modal2')
            const cerrarModales = document.querySelectorAll('.modal_close')
            const button = document.querySelector('.cant_followers')
            button.addEventListener('click', (e)=>{
                e.preventDefault()  
                modal.classList.add('modal--show')
                

            })
            for(let cerrarModal of cerrarModales){
                cerrarModal.addEventListener('click', (e)=>{
                    e.preventDefault()
                    modal.classList.remove('modal--show')
                    modal2.classList.remove('modal--show')
                })
            }
            
                
            
            const optionButtons = document.querySelectorAll('.optionButtons')
            const options = document.querySelectorAll('.options')
            const messages = document.querySelectorAll('.tweetMessage')
            optionButtons.forEach(button=>{
                button.addEventListener('click', (e)=>{
                    e.stopPropagation()
                    e.preventDefault();
                    option = button.nextElementSibling
                        if(option.getAttribute('data') == "true"){
                            option.style.display = "none"
                            option.setAttribute('data', 'false');

                        }else{
                            option.style.display = "flex"
                            option.setAttribute('data', 'true');
                        }
                        
                    
                        
                })
            })

            const msgButtons = document.querySelectorAll('.msgButton')
            const editButton = document.querySelector('.editButton')
            msgButtons.forEach(button=>{
                
                button.addEventListener('click', (e)=>{
                    e.preventDefault()  
                    modal.classList.add('modal--show')
                    console.log("hola")
                    const tweetId = button.id
                    console.log(tweetId)
                    form.action = `../../tweet/response/${tweetId}`

                })
            })

            editButton.addEventListener('click', (e)=>{

                e.preventDefault()
                modal2.classList.add('modal--show')
            })
        

        </script>
            
    {% endblock content %}

        
</body>
</html>